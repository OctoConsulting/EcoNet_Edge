FROM debian:bullseye

RUN apt-get update && apt-get upgrade -y

RUN apt-get update && apt-get install nginx -y

RUN apt-get update && apt-get install ffmpeg -y
RUN apt-get update && apt-get install procps -y

RUN apt-get update && apt-get install python3 python3-pip -y
RUN apt-get update && apt-get install python3-waitress -y

RUN pip install flask flask_sock flask_sqlalchemy flask_cors
RUN pip install requests

#RUN useradd -m -G users -s /bin/bash courier
#USER courier
#WORKDIR /home/courier

#COPY ./index.html /usr/share/nginx/html/
COPY ./index.html /var/www/html/
COPY ./test_vid.mp4 ./

COPY ./encode_vid.sh .
COPY ./encode_stream.sh .
COPY ./container_startup.sh .
COPY ./controls.py .
COPY ./app.py .

CMD [ "./container_startup.sh" ]